<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
  <title>Ø´Ø§Ù…Ù„ KSA</title>
</head>

  <!-- Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„: ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„ moment Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… moment-hijri -->
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/min/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment-hijri@3.0.0/moment-hijri.min.js"></script>

  <style>
    :root { --bg:#000; --panel:#111; --text:#f1f5f9; --accent:#6fae3f; --alert:#b22222; --gold:#FFD700; }
    body { margin:0; padding:0; background:var(--bg); color:var(--text); font-family:'Tahoma'; display:flex; flex-direction:column; min-height:100vh; }
    header { background:var(--panel); padding:12px; text-align:center; font-size:18px; font-weight:bold; color:var(--accent); }

    /* ÙƒØ±ÙˆØª Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
    .section-card { background:var(--panel); margin:6px; padding:12px; border-radius:10px; box-shadow:0 3px 6px rgba(0,0,0,0.5); color:var(--accent); }
    h2 { margin:0 0 8px 0; color:var(--gold); font-size:16px; }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù…Ø© */
    .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:6px; margin:6px 0; }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹Ø¯Ù‘ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ */
    .countdown-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(70px,1fr)); gap:6px; margin:6px 0; }

    /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ø¯Ù‘ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ (Ø§Ø³Ù… Ù…ÙˆØ­Ù‘Ø¯) */
    .countdown-card {
      background:var(--panel);
      border:1px solid rgba(111,174,63,0.5);
      width:70px; height:70px;
      margin:2px; padding:4px;
      border-radius:8px;
      font-size:10px; line-height:1.2;
      display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      text-align:center; word-break:break-word;
      box-shadow:0 2px 6px rgba(0,0,0,0.4);
      color:var(--text);
    }
    .countdown-card strong { font-size:10px; margin-bottom:2px; color:var(--gold); }
    .countdown-card.done { border-color:#2ecc71; color:#2ecc71; }
    .hl { color:var(--alert); font-weight:bold; }

    /* Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .row { display:flex; gap:8px; margin-bottom:8px; flex-wrap:wrap; }
    .input { background:#222; color:#fff; border:none; border-radius:6px; padding:4px; font-size:13px; text-align:center; width:60px; }
    .btn { background:var(--accent); color:#000; font-weight:bold; cursor:pointer; width:100%; margin-top:8px; padding:8px; border-radius:6px; border:none; font-size:14px; }

    /* Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª */
    .icon { background:var(--bg); border:2px solid var(--accent); border-radius:8px; padding:10px; text-align:center; color:var(--text); font-weight:bold; cursor:pointer; display:block; text-decoration:none; }
    .icon:hover { background:var(--accent); color:var(--bg); }

    footer { margin-top:auto; text-align:center; padding:8px; font-size:12px; color:var(--gold); }

    /* Ø¶Ø¨Ø· Ù„Ù„Ø¬ÙˆØ§Ù„ */
    @media(max-width:600px){
      header { padding:10px; font-size:17px; }
      .section-card { margin:4px; padding:10px; }
      .countdown-grid { grid-template-columns:repeat(auto-fit,minmax(60px,1fr)); gap:4px; }
      .countdown-card { width:60px; height:60px; font-size:9px; padding:4px; }
      .countdown-card strong { font-size:9px; }
      .grid { grid-template-columns:repeat(auto-fit,minmax(100px,1fr)); gap:4px; }
      .input { width:80px; }
    }
  </style>
</head>
<body>
  <header>Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</header>

  <!-- Ù…Ø­ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® --><div class="section-card converter-box">
  <div class="converter-flex">
    <div class="converter-inputs">
      <h2>Ù…Ø­ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®</h2>
      <!-- Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙƒÙ…Ø§ Ù‡ÙŠ -->
      <label>Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ:</label>
      <div class="row" id="gInputs">
        <input type="text" id="gDay" class="input" placeholder="Ø§Ù„ÙŠÙˆÙ…">
        <input type="text" id="gMonth" class="input" placeholder="Ø§Ù„Ø´Ù‡Ø±">
        <input type="text" id="gYear" class="input" placeholder="Ø§Ù„Ø³Ù†Ø©">
      </div>

      <label>Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ:</label>
      <div class="row" id="hInputs">
        <input type="text" id="hDay" class="input" placeholder="Ø§Ù„ÙŠÙˆÙ…">
        <input type="text" id="hMonth" class="input" placeholder="Ø§Ù„Ø´Ù‡Ø±">
        <input type="text" id="hYear" class="input" placeholder="Ø§Ù„Ø³Ù†Ø©">
      </div>

      <button class="btn" id="convertBtn">ØªØ­ÙˆÙŠÙ„</button>
      <div id="conversionResult" style="margin-top:6px;"></div>
    </div>

    <!-- Ø®Ø§Ù†Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ -->
    <div class="today-box">
      <h2>Ø§Ù„ÙŠÙˆÙ…</h2>
      <div id="todayDate"></div>
    </div>
  </div>
</div>
  <!-- Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ -->
  <div class="section-card">
    <h2>Ù…ØªØ¨Ù‚ÙŠ Ø¹Ù„Ù‰ :</h2>
    <div class="countdown-grid" id="countdownGrid"></div>
  </div>

  <!-- Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª -->
  <div class="section-card">
    <h2>Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª</h2>
    <div class="grid">
      <a href="retirement.html" class="icon">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯</a>
      <a href="endservice.html" class="icon">Ø­Ø§Ø³Ø¨Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø©</a>
      <a href="social.html" class="icon">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…Ø·ÙˆØ±</a>
      <a href="citizen.html" class="icon">Ø­Ø§Ø³Ø¨Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø·Ù†</a>
    </div>
  </div>

  <footer>Ù…Ù…Ø¯ÙˆØ­ Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ</footer>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      // ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆÙØ± moment + moment-hijri Ø¯ÙˆÙ† Ø¥ÙŠÙ‚Ø§Ù Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØµÙØ­Ø©
      const hasHijri = (typeof moment !== 'undefined') && moment.fn && typeof moment.fn.iYear === 'function';

      // Ø£Ø¯ÙˆØ§Øª
      function onlyDigits(s){ return String(s).replace(/\D+/g,''); }
      function pad2(n){ return String(n).padStart(2,'0'); }
      function isIntInRange(val, min, max){
        const s = String(val).trim();
        if(s === '' || !/^\d+$/.test(s)) return false;
        const n = Number(s);
        return Number.isInteger(n) && n >= min && n <= max;
      }
      function show(msg){ document.getElementById('conversionResult').textContent = msg; }

      // Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø§Ù†Ø§Øª
      function attachAutoAdvance(containerId){
        const inputs = Array.from(document.getElementById(containerId).querySelectorAll('input'));
        inputs.forEach((inp, idx)=>{
          inp.addEventListener('input', ()=>{
            inp.value = onlyDigits(inp.value);
            const maxlen = Number(inp.dataset.maxlen || 2);
            if(inp.value.length >= maxlen && idx + 1 < inputs.length){
              inputs[idx+1].focus();
              inputs[idx+1].select && inputs[idx+1].select();
            }
          });
        });
      }
      attachAutoAdvance('gInputs');
      attachAutoAdvance('hInputs');

      // Ù…Ø­ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®
      function convertDate(){
        try{
          if(!hasHijri){
            show('Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
            return;
          }

          const gD = document.getElementById("gDay").value;
          const gM = document.getElementById("gMonth").value;
          const gY = document.getElementById("gYear").value;

          const hD = document.getElementById("hDay").value;
          const hM = document.getElementById("hMonth").value;
          const hY = document.getElementById("hYear").value;

          // Ù…ÙŠÙ„Ø§Ø¯ÙŠ -> Ù‡Ø¬Ø±ÙŠ
          if(isIntInRange(gD,1,31) && isIntInRange(gM,1,12) && isIntInRange(gY,1,9999)){
            const gStr = `${gY}-${pad2(gM)}-${pad2(gD)}`;
            const mg = moment(gStr, "YYYY-MM-DD", true);
            if(!mg.isValid()){ show("ØªØ§Ø±ÙŠØ® Ù…ÙŠÙ„Ø§Ø¯ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­."); return; }
            show(`Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ: ${mg.format("iYYYY/iM/iD")}`);
            return;
          }

          // Ù‡Ø¬Ø±ÙŠ -> Ù…ÙŠÙ„Ø§Ø¯ÙŠ
          if(isIntInRange(hD,1,30) && isIntInRange(hM,1,12) && isIntInRange(hY,1,9999)){
            const mh = moment(`${Number(hY)}/${Number(hM)}/${Number(hD)}`, "iYYYY/iM/iD", true);
            if(!mh.isValid()){ show("ØªØ§Ø±ÙŠØ® Ù‡Ø¬Ø±ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­."); return; }
            show(`Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ: ${mh.format("YYYY/MM/DD")}`);
            return;
          }

          show("Ø£Ø¯Ø®Ù„ Ø§Ù„ÙŠÙˆÙ… Ø«Ù… Ø§Ù„Ø´Ù‡Ø± Ø«Ù… Ø§Ù„Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø© ÙÙŠ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ø®Ø§Ù†Ø§Øª.");
        }catch(e){
          show("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø¯Ø®Ù„Ø©.");
        }
      }
      document.getElementById('convertBtn').addEventListener('click', convertDate);

      // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¹Ø¯Ù‘ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
      const events = [
        { name: "Ø§Ù„Ø±Ø§ØªØ¨", day: 27 },
        { name: "Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯", day: 1 },
        { name: "Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…Ø·ÙˆØ±", day: 1 },
        { name: "Ø³Ø§Ù†Ø¯", day: 1 },
        { name: "Ø­Ø§ÙØ²", day: 5 },
        { name: "Ø¯Ø¹Ù… Ø±ÙŠÙ", day: 10, highlight: true },
        { name: "Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠ", day: 1 },
        { name: "Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ§Ø·Ù†", day: 10 },
        { name: "Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ", day: 24 },
        { name: "Ø§Ù„ØªØ£Ù‡ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„", day: 26 },
        // Ø«Ø§Ø¨ØªØ© Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ Ø§Ù„Ø³Ù†ÙˆÙŠ:
        { name: "Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ÙˆØ·Ù†ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", month: 8, day: 23, highlight: true },  // Ø³Ø¨ØªÙ…Ø¨Ø± (8 Ù„Ø£Ù† Ø§Ù„Ø£Ø´Ù‡Ø± ØªØ¨Ø¯Ø£ Ù…Ù† 0)
        { name: "ÙŠÙˆÙ… Ø§Ù„ØªØ£Ø³ÙŠØ³ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ", month: 1, day: 22, highlight: true }   // ÙØ¨Ø±Ø§ÙŠØ±
      ];

      function adjustWeekend(date){
        const day = date.getDay();
        if(day === 5) date.setDate(date.getDate() - 1); // Ø¬Ù…Ø¹Ø© -> Ø®Ù…ÙŠØ³
        else if(day === 6) date.setDate(date.getDate() + 1); // Ø³Ø¨Øª -> Ø£Ø­Ø¯
        return date;
      }

      function nextTargetFrom(event, now){
        // Ø¥Ù† ÙƒØ§Ù† Ø§Ù„Ø­Ø¯Ø« Ù…Ø­Ø¯Ø¯ Ø§Ù„Ø´Ù‡Ø± (Ø«Ø§Ø¨Øª Ø³Ù†ÙˆÙŠÙ‹Ø§)
        if (event.month !== undefined) {
          let t = new Date(now.getFullYear(), event.month, event.day);
          if (t < now) t = new Date(now.getFullYear() + 1, event.month, event.day);
          return adjustWeekend(t);
        }
        // Ø£Ø­Ø¯Ø§Ø« Ø´Ù‡Ø±ÙŠØ© Ø­Ø³Ø¨ ÙŠÙˆÙ… Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ/Ø§Ù„ØªØ§Ù„ÙŠ
        let t = new Date(now.getFullYear(), now.getMonth(), event.day);
        if (t < now) t = new Date(now.getFullYear(), now.getMonth() + 1, event.day);
        return adjustWeekend(t);
      }

     function updateCountdowns(){
  const now = new Date();
  const grid = document.getElementById("countdownGrid");
  if(!grid) return;

  grid.innerHTML = "";

  const countdowns = events.map(event=>{
    const target = nextTargetFrom(event, now);
    const diff = target - now;

    const days = Math.floor(diff / (1000*60*60*24));
    const hours = Math.floor(diff / (1000*60*60));

    let text;
    if (diff <= 0) {
      // ÙŠÙˆÙ… Ø§Ù„ØµØ±Ù Ù†ÙØ³Ù‡
      text = "Ø§Ù„ÙŠÙˆÙ… âœ…";
    } else if (days > 0) {
      // Ø¥Ø°Ø§ Ø¨Ø§Ù‚ÙŠ Ø£ÙƒØ«Ø± Ù…Ù† ÙŠÙˆÙ…
      text = `Ù…ØªØ¨Ù‚ÙŠ ${days} ÙŠÙˆÙ…`;
    } else {
      // Ø¥Ø°Ø§ Ø£Ù‚Ù„ Ù…Ù† ÙŠÙˆÙ… (ÙŠØ¹Ù†ÙŠ Ø¨Ø§Ù„Ø³Ø§Ø¹Ø§Øª ÙÙ‚Ø·)
      text = `Ù…ØªØ¨Ù‚ÙŠ ${hours} Ø³Ø§Ø¹Ø©`;
    }

    return { name:event.name, highlight:event.highlight, time:diff, text };
  });

  countdowns.sort((a,b)=>a.time - b.time);

  countdowns.forEach(item=>{
    const card = document.createElement("div");
    card.className = "countdown-card" + (item.text.includes("Ø§Ù„ÙŠÙˆÙ…") ? " done" : "");
    const nameHtml = `<strong class="${item.highlight ? 'hl' : ''}">${item.name}</strong>`;
    const content = `${nameHtml}<br>${item.text}`;
    card.innerHTML = content;
    grid.appendChild(card);
  });
}

      updateCountdowns();
      setInterval(updateCountdowns, 1000);
    });
  </script>
<button id="installApp" style="
  display:none;
  background: linear-gradient(135deg, #006400, #c0a060);
  color: white;
  font-size: 18px;
  font-weight: bold;
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
">
ğŸ“± ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¥Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚
</button>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/shamel/sw.js');
  }

  let deferredPrompt;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('installApp').style.display = 'inline-block';

    document.getElementById('installApp').addEventListener('click', () => {2
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        deferredPrompt = null;
      });
    });
  });
</script>
  <script>
document.addEventListener('DOMContentLoaded', function(){
  const today = new Date();
  const gDate = today.toLocaleDateString('ar-SA'); // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ
  const hDate = moment(today).format("iYYYY/iM/iD"); // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… moment-hijri

  document.getElementById("todayDate").innerHTML =
    `ğŸ“… Ø§Ù„ÙŠÙˆÙ…: ${gDate} (Ù…ÙŠÙ„Ø§Ø¯ÙŠ) | ${hDate} (Ù‡Ø¬Ø±ÙŠ)`;
});
</script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
  const now = new Date();

  // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ (Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)
  const gDate = now.toLocaleDateString('ar-SA', {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });

  // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… moment-hijri
  const hDate = moment(now).format("iYYYY/iM/iD");

  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ Ø¹Ù†ØµØ± Ù…Ø®ØµØµ
  const todayBox = document.getElementById('todayDate');
  if (todayBox) {
    todayBox.innerHTML = `ğŸ“… Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ: ${gDate}<br>ğŸ•Œ Ø§Ù„Ù‡Ø¬Ø±ÙŠ: ${hDate}`;
  }
});
</script>
</body>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(() => console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"))
      .catch(err => console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„", err));
  }
</script>
</html>








